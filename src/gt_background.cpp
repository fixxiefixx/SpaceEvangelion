#include "gt_background.h"

#include "bn_regular_bg_items_bg.h"
#include "bn_regular_bg_items_blue_space_bg.h"

#include "bn_regular_bg_items_hangar_bg0000.h"
#include "bn_regular_bg_items_hangar_bg0001.h"
#include "bn_regular_bg_items_hangar_bg0002.h"
#include "bn_regular_bg_items_hangar_bg0003.h"
#include "bn_regular_bg_items_hangar_bg0004.h"
#include "bn_regular_bg_items_hangar_bg0005.h"
#include "bn_regular_bg_items_hangar_bg0006.h"
#include "bn_regular_bg_items_hangar_bg0007.h"
#include "bn_regular_bg_items_hangar_bg0008.h"
#include "bn_regular_bg_items_hangar_bg0009.h"
#include "bn_regular_bg_items_hangar_bg0010.h"
#include "bn_regular_bg_items_hangar_bg0011.h"
#include "bn_regular_bg_items_hangar_bg0012.h"
#include "bn_regular_bg_items_hangar_bg0013.h"
#include "bn_regular_bg_items_hangar_bg0014.h"
#include "bn_regular_bg_items_hangar_bg0015.h"
#include "bn_regular_bg_items_hangar_bg0016.h"
#include "bn_regular_bg_items_hangar_bg0017.h"
#include "bn_regular_bg_items_hangar_bg0018.h"
#include "bn_regular_bg_items_hangar_bg0019.h"
#include "bn_regular_bg_items_hangar_bg0020.h"
#include "bn_regular_bg_items_hangar_bg0021.h"
#include "bn_regular_bg_items_hangar_bg0022.h"
#include "bn_regular_bg_items_hangar_bg0023.h"
#include "bn_regular_bg_items_hangar_bg0024.h"
#include "bn_regular_bg_items_hangar_bg0025.h"
#include "bn_regular_bg_items_hangar_bg0026.h"
#include "bn_regular_bg_items_hangar_bg0027.h"
#include "bn_regular_bg_items_hangar_bg0028.h"
#include "bn_regular_bg_items_hangar_bg0029.h"
#include "bn_regular_bg_items_hangar_bg0030.h"
#include "bn_regular_bg_items_hangar_bg0031.h"
#include "bn_regular_bg_items_hangar_bg0032.h"
#include "bn_regular_bg_items_hangar_bg0033.h"
#include "bn_regular_bg_items_hangar_bg0034.h"
#include "bn_regular_bg_items_hangar_bg0035.h"
#include "bn_regular_bg_items_hangar_bg0036.h"
#include "bn_regular_bg_items_hangar_bg0037.h"
#include "bn_regular_bg_items_hangar_bg0038.h"
#include "bn_regular_bg_items_hangar_bg0039.h"
#include "bn_regular_bg_items_hangar_bg0040.h"
#include "bn_regular_bg_items_hangar_bg0041.h"
#include "bn_regular_bg_items_hangar_bg0042.h"
#include "bn_regular_bg_items_hangar_bg0043.h"
#include "bn_regular_bg_items_hangar_bg0044.h"
#include "bn_regular_bg_items_hangar_bg0045.h"
#include "bn_regular_bg_items_hangar_bg0046.h"
#include "bn_regular_bg_items_hangar_bg0047.h"
#include "bn_regular_bg_items_hangar_bg0048.h"
#include "bn_regular_bg_items_hangar_bg0049.h"
#include "bn_regular_bg_items_hangar_bg0050.h"
#include "bn_regular_bg_items_hangar_bg0051.h"
#include "bn_regular_bg_items_hangar_bg0052.h"
#include "bn_regular_bg_items_hangar_bg0053.h"
#include "bn_regular_bg_items_hangar_bg0054.h"
#include "bn_regular_bg_items_hangar_bg0055.h"
#include "bn_regular_bg_items_hangar_bg0056.h"
#include "bn_regular_bg_items_hangar_bg0057.h"
#include "bn_regular_bg_items_hangar_bg0058.h"
#include "bn_regular_bg_items_hangar_bg0059.h"



#define __ background

namespace
{
    constexpr const bn::regular_bg_item  backgrounds[] = {bn::regular_bg_items::hangar_bg0000,
bn::regular_bg_items::hangar_bg0001,
bn::regular_bg_items::hangar_bg0002,
bn::regular_bg_items::hangar_bg0003,
bn::regular_bg_items::hangar_bg0004,
bn::regular_bg_items::hangar_bg0005,
bn::regular_bg_items::hangar_bg0006,
bn::regular_bg_items::hangar_bg0007,
bn::regular_bg_items::hangar_bg0008,
bn::regular_bg_items::hangar_bg0009,
bn::regular_bg_items::hangar_bg0010,
bn::regular_bg_items::hangar_bg0011,
bn::regular_bg_items::hangar_bg0012,
bn::regular_bg_items::hangar_bg0013,
bn::regular_bg_items::hangar_bg0014,
bn::regular_bg_items::hangar_bg0015,
bn::regular_bg_items::hangar_bg0016,
bn::regular_bg_items::hangar_bg0017,
bn::regular_bg_items::hangar_bg0018,
bn::regular_bg_items::hangar_bg0019,
bn::regular_bg_items::hangar_bg0020,
bn::regular_bg_items::hangar_bg0021,
bn::regular_bg_items::hangar_bg0022,
bn::regular_bg_items::hangar_bg0023,
bn::regular_bg_items::hangar_bg0024,
bn::regular_bg_items::hangar_bg0025,
bn::regular_bg_items::hangar_bg0026,
bn::regular_bg_items::hangar_bg0027,
bn::regular_bg_items::hangar_bg0028,
bn::regular_bg_items::hangar_bg0029,
bn::regular_bg_items::hangar_bg0030,
bn::regular_bg_items::hangar_bg0031,
bn::regular_bg_items::hangar_bg0032,
bn::regular_bg_items::hangar_bg0033,
bn::regular_bg_items::hangar_bg0034,
bn::regular_bg_items::hangar_bg0035,
bn::regular_bg_items::hangar_bg0036,
bn::regular_bg_items::hangar_bg0037,
bn::regular_bg_items::hangar_bg0038,
bn::regular_bg_items::hangar_bg0039,
bn::regular_bg_items::hangar_bg0040,
bn::regular_bg_items::hangar_bg0041,
bn::regular_bg_items::hangar_bg0042,
bn::regular_bg_items::hangar_bg0043,
bn::regular_bg_items::hangar_bg0044,
bn::regular_bg_items::hangar_bg0045,
bn::regular_bg_items::hangar_bg0046,
bn::regular_bg_items::hangar_bg0047,
bn::regular_bg_items::hangar_bg0048,
bn::regular_bg_items::hangar_bg0049,
bn::regular_bg_items::hangar_bg0050,
bn::regular_bg_items::hangar_bg0051,
bn::regular_bg_items::hangar_bg0052,
bn::regular_bg_items::hangar_bg0053,
bn::regular_bg_items::hangar_bg0054,
bn::regular_bg_items::hangar_bg0055,
bn::regular_bg_items::hangar_bg0056,
bn::regular_bg_items::hangar_bg0057,
bn::regular_bg_items::hangar_bg0058,
bn::regular_bg_items::hangar_bg0059
};

    const bn::regular_bg_item get_bg(int level)
    {
        switch(level)
        {
            default:
            case 0:
            {
                return bn::regular_bg_items::bg;
            }break;
            case 1:
            {
                return bn::regular_bg_items::blue_space_bg;

            }break;
            case 2:
            {
                return backgrounds[0];
            }break;
        }
    }

}

namespace gt
{

    __::__(int level):bg(get_bg(level).create_bg(8, 6*8))
    {
        _level = level;
        bg.set_blending_enabled(true);
        bn::blending::set_fade_alpha(0);
    }

    void __::update()
    {
        if(_level == 2 && !fading_out)
        {
            bg.set_item(backgrounds[bg_index]);

            bg_index++;
            if(bg_index >= sizeof(backgrounds) / sizeof(bn::regular_bg_item))
            {
                bg_index = 0;
            }
        }
        else
        {
            bn::fixed_point pos = bg.position();
            pos.set_x(pos.x() - bn::fixed(0.25));
            bg.set_position(pos);
        }

        if(fading_in)
        {
            if(blending_action_opt->done())
            {
                fading_in = false;
                
            }
            else
            {
                blending_action_opt->update();
            }
        }

        if(fading_out)
        {
            if(blending_action_opt->done())
            {
                fading_out = false;
                fading_in = true;
                switch(_level)
                {
                    case 0:
                    {
                        bg.set_item(bn::regular_bg_items::bg);
                    }break;
                    case 1:
                    {
                        bg.set_item(bn::regular_bg_items::blue_space_bg);

                    }break;
                    case 2:
                    {
                        bg.set_item(backgrounds[0]);
                        bg_index = 0;
                        bg.set_position(8, 6*8);
                    }break;
                }
                blending_action_opt = bn::optional(bn::blending_fade_alpha_to_action(60*2,0));
            }
            else
            {
                blending_action_opt->update();
            }
        }

    }

    void __::set_level(int level, bool fade)
    {
        if(_level != level)
        {
            _level = level;
            if(fade)
            {
                fading_out = true;
                fading_in = false;
                bn::blending::set_fade_color(bn::blending::fade_color_type::BLACK);
                blending_action_opt = bn::optional(bn::blending_fade_alpha_to_action(60*2,1));
            }
            else
            {
                fading_out = false;
                fading_in = false;
                switch(level)
                {
                    default:
                    case 0:
                    {
                        bg.set_item(bn::regular_bg_items::bg);
                    }break;
                    case 1:
                    {
                        bg.set_item(bn::regular_bg_items::blue_space_bg);

                    }break;
                    case 2:
                    {
                        bg.set_item(backgrounds[0]);
                        bg_index = 0;
                        
                    }break;
                }
            }
        }
    }
            
    
    int __::level()
    {
        return _level;
    }

}